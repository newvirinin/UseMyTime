@startuml UseMyTime ER Diagram

skinparam linetype ortho
skinparam nodesep 60
skinparam ranksep 60

class "Пользователь" as User {
  **ПК** ИД: число
  ====
  Имя пользователя: строка
  Email: строка
  Хэш-пароль: строка
  Суперпользователь: булево
  Активен: булево
  Последний вход: дата-время
  Дата регистрации: дата-время
}

class "Профиль пользователя" as Profile {
  **ПК** ИД: число
  ====
  **ВК** ИД_пользователь: число
  Отчество: строка
  Должность: строка
  Внутренний номер: строка
  Фото: строка (путь к файлу)
  Роль: строка
  Контроллер: начальник сектора
  начальник отдела
  генеральный директор
  --
  **ВК** ИД_отдел: число
  --
  **ВК** ИД_руководитель: число
}

class "Отдел" as Department {
  **ПК** ИД: число
  ====
  Название отдела: строка
}

class "Проект" as Project {
  **ПК** ИД: число
  ====
  **ВК** ИД_пользователь: число
  Название проекта: строка
  Описание: текст
  Создание: дата-время
  Архив: булево
  Затраченное время: строка
  Статус проверки: строка
  (не на проверке | на проверке
  принят | возвращен)
  --
  **ВК** ИД_отправил_на_проверку: число
  Когда отправлен на проверку: дата-время
  --
  **ВК** ИД_проверил: число
  Когда проверен: дата-время
  Комментарий проверки: текст
  Комментарий для отправки
  на проверку: текст
}

class "Активный проект" as ActiveProject {
  **ПК** ИД: число
  ====
  **ВК** ИД_пользователь: число
  --
  **ВК** ИД_проект: число
  В работе: булево
  Начало: дата-время
  Окончание: дата-время
}

class "Таймер проекта" as ProjectTimer {
  **ПК** ИД: число
  ====
  **ВК** ИД_пользователь: число
  --
  **ВК** ИД_проект: число
  --
  **ВК** ИД_текущая_задача: число
  Идёт отсчёт: булево
  Время запуска: дата-время
  Стоп: дата-время
}

class "Задача" as Task {
  **ПК** ИД: число
  ====
  **ВК** ИД_проект: число
  Описание задачи: текст
  Выполнена: булево
  Дата создания: дата-время
  Дата начала: дата-время
  Дата завершения: дата-время
  Статус: строка
  (новая | в работе | готово)
}

class "Вложение задачи" as TaskAttachment {
  **ПК** ИД: число
  ====
  **ВК** ИД_задача: число
  Файл: строка (путь к файлу)
  Дата загрузки: дата-время
}

class "Интервал работы" as TimeEntry {
  **ПК** ИД: число
  ====
  **ВК** ИД_пользователь: число
  --
  **ВК** ИД_проект: число
  --
  **ВК** ИД_задача: число
  Начало интервала: дата-время
  Конец интервала: дата-время
  Длительность: дата-время
  Дата создания: дата-время
}

class "Вложения проекта" as ProjectAttachment {
  **ПК** ИД: число
  ====
  **ВК** ИД_проект: число
  Файл: строка (путь к файлу)
  --
  **ВК** ИД_загрузил: число
  Дата загрузки: дата-время
}

class "Вопрос" as Question {
  **ПК** ИД: число
  ====
  **ВК** ИД_Пользователь: число
  Имя: строка
  Email: строка
  Вопрос: текст
  Закрыт: булево
  Создан: дата-время
}

User "1" -- "1" Profile
Profile "*" -- "1" Department
Profile "*" -- "0..1" Profile

User "1" -- "*" Project
User "1" -- "0..1" ActiveProject
ActiveProject "*" -- "0..1" Project

User "1" -- "*" ProjectTimer
ProjectTimer "*" -- "1" Project
ProjectTimer "*" -- "0..1" Task

Project "1" -- "*" Task
Task "1" -- "*" TaskAttachment

User "1" -- "*" TimeEntry
TimeEntry "*" -- "1" Project
TimeEntry "*" -- "0..1" Task

Project "1" -- "*" ProjectAttachment
ProjectAttachment "*" -- "1" User

User "1" -- "*" Question

@enduml
